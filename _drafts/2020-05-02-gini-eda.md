---
layout: page-fullwidth
title: "Measuring Statistical Dispersion with the Gini Coefficient"
subheadline: "Exploratory Data Analysis"
meta_teaser: "A blog post about Gini!"
teaser: "<em>A blog post about Gini!</em>"

header:
    image: birthday_planet_header.jpg
    background-color: "#999999"
    caption: "Voyager Montage by NASA. Public Domain. Credit: NASA."
    caption_url: https://www.nasa.gov/index.html
image:
    thumb: birthday_planet_thumb.jpg
    homepage: birthday_planet_header.jpg
    caption: "Credit: NASA"
    caption_url: https://www.nasa.gov/index.html
categories:
    - mathematics
    - eda
show_meta: true
comments: true
---
<!--more-->

<!--
Content for "abstract" including
- What is statistical dispersion?
- Metric developed by Gini
- UN uses it for ranking countries: wealth vs. income inequality
- I suggest expanding its use to be part of your EDA (measures overall statistical dispersion, yo!)
-->

If you work with data long enough, you are bound to discover that calculating the average of a set of values rarely tells you the full data story.  As a simple example, each of the following groups of people have the same **average pay** of $100:
- 100 people who make $100 each
- 50 people who make $150 each and 50 people who make $50
- 1 person who makes $10,000 and 99 people who make nothing

The primary difference is the way money is distributed among each of the 100 people.  Here, the spread of money  [statistical dispersion][1].  Perhaps the most popular measurement of dispersion is standard deviation or variance.  Standard deviation roughly measures the distance between individual dataset values and the overall group mean. Standard deviation retains the same units as the quantity being measured, since we start with dollars in the previous example, standard deviation will also be reported in dollars.  But other unitless metrics can also be used to understand statistical dispersion.  

One such measurement, [the Gini coefficient][2] also known as the Gini index or Gini ratio, was published in 1912 by Italian statistician and sociologist Corrado Gini.  The historical use of this unitless measure of statistical dispersion has aimed at income or wealth distributions; in fact, despite being developed over 100 years ago, [the United Nations still uses the Gini coefficient in their annual ranking of nations][3] to understand wealth inequities. But the Gini coefficient can be used much more broadly to understand the dispersion of very diverse datasets.  After a more in depth exploration of the formula behind the Gini coefficient, let's take a look at a few use cases that do not involve international economies thus demonstrating that the Gini coefficient can be added to your EDA process to strengthen your analyses.

<span style='color:blue'>Add something on a set where the standard deviation doesn't cut it either</span>

<!--
- Typical definition involving Lorenz curve
- Main idea: Area shrinks as curve pulls away from straight line
- Include approximation via Pareto principle?  (Or save for final takeaways?)
-->




## Defining Gini


To understand the Gini coefficient, let's first discuss the Lorenz curve, a graph developed by Max Lorenz for visualizing income or wealth distribution.  The premise of the curve goes like this: take the incomes of a population and sort them from smallest to greatest.  Then visualize these incomes in a line plot where the \\(x\\)-values represent the percentage of people seen thus far and the \\(y\\)-values represent the cumulative proportion of wealth accumulated by this percentage of people.  For example, if the poorest 30% of the population holds 10% of a population's wealth, the curve should pass through the scaled \\(x,y\\) coordinates (0.3, 0.1).  And note that if wealth were distributed evenly among all members of a population, the Lorenz curve would be a straight, 45-degree line where \\(x=y\\), where 30% of the people have 30% of the wealth, etc.

<div class="row">
  <div class="large-6 columns">
      <img src="{{ site.urlimg }}gini_explanation.png" alt="The areas surrounding the Lorenz curve define the Gini coefficient: A/(A+B)" width = "380">
  </div>
  <div class="large-6 columns">
      <img src="{{ site.urlimg }}gini_animation.gif" alt="The Gini coefficient increases as the inequity gap widens." width = "380">
  </div>
</div>

<br>

The Gini coefficient measures how much a population's data deviates from perfectly even distribution. Assuming positive data values [^1], the Gini coefficient ranges from zero to one, where

- zero represents perfect equality (everyone has an equal amount) and 
- one represents near perfect inequality (one person has all the money).  

For all situations in between, the Gini coefficient is thus calculated as the area enclosed between the Lorenz curve and the line of perfect equality, marked as \\(A\\) in the figure above, divided by the total triangular area, \\(A + B\\).

[^1]: The Gini coefficient is strictly non-negative, \\(G \geq 0\\), as long as the mean of the data is assumed positive.  Gini can theoretically be greater than one if some data values are negative, which occurs in the context of wealth if some people contribute to the population's wealth negatively in the form of debts owed.


Returning to the examples discussed at the beginning of this post, each situation results in an average pay of $100 per person, but the Gini coefficient varies greatly for each scenario because Gini measures statistical dispersion.  Calculation of the Gini coefficient may prove useful for any problem or dataset where dispersion plays an important role. <span style="color:blue">(out at as a quote?)</span>


<img src="{{ site.urlimg }}gini_compare.png" alt="Gini coefficient increases with wealth inequity." width = "1200">




## Gini in Python

To calculate the Gini coefficient in Python, one option is to integrate the area between the two curves numerically, using [quadrature][4] from the `scipy` library for example.  Numerical integration may prove too slow or too complicated for applications at scale, however, so more straightforward implementations often begin from an alternative, [equivalent definition of the Gini coefficient][5]:
> The Gini coefficient \\(G\\) is also defined as half of the data's [relative mean absolute difference][6], which is a normalized form of the average absolute difference among all the pairs of observations in the dataset. 
\\[ G = \frac{\sum\limits_i \sum\limits_j |x_i - x_j|}{2\sum\limits_i\sum\limits_j x_j}\\]

As long as the data contains only positive, non-zero values, it is [not necessary to compute all possible pairs][7].  The calculation simplifies further by placing all values in ascending order and assigning an index \\(i\\), which ranges from 1 for the smallest value up to the size of the dataset \\(n\\) for the largest value.  The resulting formula for Gini
\\[G = \frac{\sum\limits_i (2i - n - 1)x_i}{n\sum\limits_i x_i} \\]
is equivalent and even speedier to compute with Python.  

The best Python implementation of this calculation comes from [Olivia Guest][8]; I will be using Olivia's vectorized, `numpy` Gini function in the case studies that follow.


## Case \#1: Baby Names

- Dataset
- Top names are all males which leads to theory of different statistical dispersion
- Measure Gini across time

So far I have provided examples of the Gini coefficient applied to its original field: economics.  Calculation of the Gini coefficient generalizes, however, to any dataset where statistical dispersion plays a critical role.  I will now illustrate two non-typical applications to demonstrate that calculation of the Gini coefficient could be added to improve the workflow of standard exploratory data analysis procedures.

The Social Security Administration of the United States [hosts public records][9] of the first names given to babies registered with the SSA for researchers interested in naming trends.  When exploring this dataset for children born in 1950 or later, I discovered that 18 out of the top 20 most popular names were most commonly given to male children, so where were the female names?  

<center>
<img src="{{ site.urlimg }}popular_names.png" alt="Most popular names given to US babies since 1950" width = "500">
</center>

It is true that [male births are slightly more likely][10] and more male babies have been registered with the SSA over the years -- 53% male vs 47% female; nonetheless, I was still surprised to see such a larger proportion of male names in the popularity charts.[10]  After digging into the data further, I found that even though there are fewer females in the dataset, there have been consistently more unique female names each year.  


## Case \#2: Healthcare Prices

- Different procedures have different distributions -- need regulation or more transparency?

## Conclusion

- Recap of findings
- Pros and Cons of Gini
- Why not standard dev?
- Metric is lossy: exmaples of two distributions that have the same Gini values
- As with any metric, next step is WHY?  (Gini for nation's inequality can miss aging population, government assistance, etc.) 
Domain knowledge is critical!

[Check out this code on GitHub!](https://github.com/kimfetti/Blog/blob/master/planetary_birthday_problem.ipynb)  ||  [Check out this viz on Tableau!](https://public.tableau.com/profile/kimberly.fessel#!/vizhome/PlanetaryBirthdayProblem/Planets-50)

 [1]: https://en.wikipedia.org/wiki/Statistical_dispersion
 [2]: https://en.wikipedia.org/wiki/Gini_coefficient
 [3]: https://www.bbc.com/news/blogs-magazine-monitor-31847943
 [4]: https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html
 [5]: https://en.wikipedia.org/wiki/Gini_coefficient#Definition
 [6]: https://en.wikipedia.org/wiki/Mean_absolute_difference#Relative_mean_absolute_difference
 [7]: https://www.statsdirect.com/help/default.htm#nonparametric_methods/gini.htm
 [8]: https://github.com/oliviaguest/gini/blob/master/gini.py
 [9]: https://www.ssa.gov/oact/babynames/limits.html
 [10]: https://www.npr.org/sections/health-shots/2015/03/30/396384911/why-are-more-baby-boys-born-than-girls